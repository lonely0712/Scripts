<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Shadowrocket Modules</title>
  <link rel="stylesheet" href="/static/index.css">
</head>
<body data-page="sh">
  <h1>Shadowrocket Module Installer</h1>
  <p>Tap below to install directly in Shadowrocket</p>

  <div class="module-list" id="moduleList"></div>

  <script>
    const isIOS = /iP(hone|od|ad)/i.test(navigator.userAgent);

    fetch('/static/modules.json')
      .then(res => res.json())
      .then(modules => {
        const container = document.getElementById('moduleList');
        modules.forEach(mod => {
          const item = document.createElement('div');
          item.className = 'module-item';

          const title = document.createElement('span');
          title.className = 'module-title';
          title.textContent = mod.name;

          const link = document.createElement('a');
          link.className = 'install-button';
          const fileUrl = `https://hub.adham.wuaze.com/modules/${mod.file}`;

          if (isIOS) {
            link.href = `shadowrocket://install?module=${encodeURIComponent(fileUrl)}`;
          } else {
            link.href = fileUrl;
            link.download = mod.file;
            link.onclick = () => alert('Open this page in Safari on iOS with Shadowrocket installed.');
          }

          link.textContent = 'Install';
          item.appendChild(title);
          item.appendChild(link);
          container.appendChild(item);
        });
      })
      .catch(() => {
        document.getElementById('moduleList').textContent = 'Failed to load modules.';
      });
  </script>
</body>
</html>
